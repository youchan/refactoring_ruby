# 第6章 メソッドの構成方法


## このメモについて
このメモは、2019年に行われた「リファクタリング:Rubyエディション」輪読会の読書メモです。

## 6.1 メソッドの抽出（Extract Method）
- 「メソッド名とメソッドの中身の意味的な距離」👍
  - この間`created?`ってつけたけど、`present?`だったなと反省した
-  [Clarity over brevity in variable and method names](https://signalvnoise.com/posts/3250-clarity-over-brevity-in-variable-and-method-names)

- inject、GOODだ ( ex: 6.11 )
    - 足すだけならArray#sumの方がすっきりしそうに思いました

- リーダブルコードも読み直したい
- Macの標準辞書が良い←すごいいい！！！！

## 6.2 メソッドのインライン化（Inline Method）

**メソッドの本体が名前と同じくらいわかりやすい場合、** メソッドのインライン化を行う

- たしかにこれぐらいの長さだとインライン化してもいいかも
- 切り分け方が不適切な場合、一旦全部インライン化した上で、切り直すってのはいいな
    - インライン化を利用して一旦冗長な書き方に戻した方が、手が動きやすいのはありそう。
    - ↑既存ロジックの再検討もできますしね
    - たくさんあるとテストをちゃんと書くのが大変そう。
        - そういうときはインライン化ではなく他の方法が使えないか考えてみる
- 「移譲の山の中で迷子」←:aruaru:
- Gemのコード読んでると、メソッド切りだしめっちゃしててひたすらジャンプすることが多い印象
- 手順1って、単純にサブクラスに同じメソッドがあってオーバーライド/新しく定義してたら、期待した返り値にならないからまずいという解釈であってる？？

### 関連するパターン
- 6.9メソッドからメソッドオブジェクトへ

## 6.3 一時変数のインライン化(Inline Temp)
- これ1章で出てたかも？
- 私だったらやたらメソッドチェーンな呼び出しの場合は、呼び出しが１回だけでも一時変数がいいと考えるかな  :+1:
    - 3回ぐらいチェーンしてたら一時変数にいれたくなるかも？by nekoさん
    - private メソッドに切り出してもいいかも
- `current_user.connected_accounts.account_holder_name`みたいな長い名前の時はいれたくなったりする
    - こういうのは `delegate` したくなるかも

- これ単体だとあまり使われない説
    - ○○説って書いてあるとくめさんだ！っていう目印になる説
    - :naruhodo:

ex)
- 一時変数から問い合わせメソッドへ
- メソッドの抽出

## 6.4 一時変数から問い合わせメソッドへ（Replace Temp with Query）
- わー、行数減ってスッキリってなるのがリファクタリングの醍醐味ですねえ
    - 結果、読みやすくもなる
- リファクタリングRuby読み始めたら、ループやif文を見たら警戒するようになった
- ループを一時変数に格納 :see_no_evil: 

- メソッドをクラス間で移動させるときはテストをどう利用するのか？
    - 例えばファットコントローラーを解消したくて、モデルにメソッドを移動するとき。
        - いったんsystem specを書く
        - モデルにメソッド移動する
        - models specを書く&詳細なものを追加していく
